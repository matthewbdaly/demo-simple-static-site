<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta property="fb:app_id" content=""/>
        <link rel="stylesheet" type="text/css" href="/static/bower_components/bootstrap-sass/dist/css/bootstrap.min.css" media="all" />
        <link rel="stylesheet" type="text/css" href="/static/bower_components/flat-ui/dist/css/flat-ui.min.css" media="all" />
        <link rel="stylesheet" type="text/css" href="/static/bower_components/highlightjs/styles/zenburn.css" media="all" />
        <link rel="alternate" type="application/rss+xml" title="A Series of Quite Extraordinary Events - feed" href="/index.xml" />
        <title>A Series of Quite Extraordinary Events - Django blog tutorial - the next generation - part 4</title>
    </head>
    <body>
        <header>
            <div class="container">
                <div class="page-header">
                    <h1>A Series of Quite Extraordinary Events</h1>
                    <h2>Being the blog of Matthew Daly Esquire</h2>
                    <nav>
                        <a href="/">Home</a> | <a href="/archive.html">Archives</a> | <a href="/about.html">About</a> | <a href="/rss.xml">RSS</a>
                    </nav>
                </div>
            </div>
        </header>

        <div class="container">
            <article class="post">
    
  <div class="title">
    <h1><a href="/posts/2014-02-15-django-blog-tutorial-the-next-generation-part-4.html">Django blog tutorial - the next generation - part 4</a></h1>
  </div>
  <section>
    <p>Hello again! As promised, in this instalment we&#39;ll implement categories and tags, as well as an RSS feed.</p>
<p>As usual, we need to switch into our virtualenv:</p>
<pre><code class="lang-bash">source venv/bin/activate</code></pre>
<h2 id="categories">Categories</h2>
<p>It&#39;s worth taking a little time at this point to set out what we mean by categories and tags in this case, as the two can be very similar. In this case, we&#39;ll use the following criteria:</p>
<ul>
<li>A post can have only one category, or none, but a category can be applied to any number of posts</li>
<li>A post can have any number of tags, and a tag can be applied to any number of posts</li>
</ul>
<p>If you&#39;re not too familiar with relational database theory, the significance of this may not be apparent, so here&#39;s a quick explanation. Because the categories are limited to one per post, the relationship between a post and a category is known as <em>one-to-many</em>. In other words, one post can only have one category, but one category can have many posts. You can therefore define the categories in one table in your database, and refer to them by their ID (the reference to the category in the post table is referred to as a <em>foreign key</em>).</p>
<p>As usual, we will write a test first. Open up <code>blogengine/tests.py</code> and edit the line importing the <code>Post</code> model as follows:</p>
<p>``` python blogengine/tests.py
from blogengine.models import Post, Category</p>
<pre><code>
Also, add the following method before `test_create_post`:

``` python blogengine/tests.py
    <span class="function"><span class="keyword">def</span> <span class="title">test_create_category</span><span class="params">(self)</span>:</span>
        <span class="comment"># Create the category</span>
        category = Category()

        <span class="comment"># Add attributes</span>
        category.name = <span class="string">'python'</span>
        category.description = <span class="string">'The Python programming language'</span>

        <span class="comment"># Save it</span>
        category.save()

        <span class="comment"># Check we can find it</span>
        all_categories = Category.objects.all()
        self.assertEquals(len(all_categories), <span class="number">1</span>)
        only_category = all_categories[<span class="number">0</span>]
        self.assertEquals(only_category, category)

        <span class="comment"># Check attributes</span>
        self.assertEquals(only_category.name, <span class="string">'python'</span>)
        self.assertEquals(only_category.description, <span class="string">'The Python programming language'</span>)</code></pre>
<p>This test checks that we can create categories. But categories aren&#39;t much use unless we can actually apply them to our posts. So we need to edit our <code>Post</code> model as well, and to do so we need to have a test in place first. Edit the <code>test_create_post</code> method as follows:</p>
<p>``` python blogengine/tests.py
    def test_create_post(self):</p>
<pre><code>    <span class="comment"># Create the category</span>
    category = Category()
    category.<span class="property">name</span> = 'python'
    category.description = 'The Python programming language'
    category.save()

    <span class="comment"># Create the author</span>
    author = User.objects.create_user('testuser', 'user@example.com', 'password')
    author.save()

    <span class="comment"># Create the site</span>
    site = Site()
    site.<span class="property">name</span> = 'example.com'
    site.domain = 'example.com'
    site.save()

    <span class="comment"># Create the post</span>
    post = Post()

    <span class="comment"># Set the attributes</span>
    post.title = 'My <span class="keyword">first</span> post'
    post.<span class="type">text</span> = 'This <span class="keyword">is</span> <span class="keyword">my</span> <span class="keyword">first</span> blog post'
    post.slug = '<span class="keyword">my</span>-<span class="keyword">first</span>-post'
    post.pub_date = timezone.now()
    post.author = author
    post.site = site
    post.category = category

    <span class="comment"># Save it</span>
    post.save()

    <span class="comment"># Check we can find it</span>
    all_posts = Post.objects.all()
    self.assertEquals(len(all_posts), <span class="number">1</span>)
    only_post = all_posts[<span class="number">0</span>]
    self.assertEquals(only_post, post)

    <span class="comment"># Check attributes</span>
    self.assertEquals(only_post.title, 'My <span class="keyword">first</span> post')
    self.assertEquals(only_post.<span class="type">text</span>, 'This <span class="keyword">is</span> <span class="keyword">my</span> <span class="keyword">first</span> blog post')
    self.assertEquals(only_post.slug, '<span class="keyword">my</span>-<span class="keyword">first</span>-post')
    self.assertEquals(only_post.site.<span class="property">name</span>, 'example.com')
    self.assertEquals(only_post.site.domain, 'example.com')
    self.assertEquals(only_post.pub_date.<span class="property">day</span>, post.pub_date.<span class="property">day</span>)
    self.assertEquals(only_post.pub_date.<span class="property">month</span>, post.pub_date.<span class="property">month</span>)
    self.assertEquals(only_post.pub_date.<span class="property">year</span>, post.pub_date.<span class="property">year</span>)
    self.assertEquals(only_post.pub_date.hour, post.pub_date.hour)
    self.assertEquals(only_post.pub_date.minute, post.pub_date.minute)
    self.assertEquals(only_post.pub_date.<span class="keyword">second</span>, post.pub_date.<span class="keyword">second</span>)
    self.assertEquals(only_post.author.username, 'testuser')
    self.assertEquals(only_post.author.email, 'user@example.com')
    self.assertEquals(only_post.category.<span class="property">name</span>, 'python')
    self.assertEquals(only_post.category.description, 'The Python programming language')</code></pre>
<pre><code>
What we<span class="comment">'re doing here is adding a `category` attribute to the posts. This attribute contains a reference to a `Category` object.</span>

<span class="built_in">Now</span>, we also want <span class="keyword">to</span> test adding, editing, <span class="keyword">and</span> deleting a category from the admin interface. Add this code <span class="keyword">to</span> the `AdminTest` <span class="keyword">class</span>:

``` python blogengine/tests.py
    def test_create_category(self):
        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Check <span class="built_in">response</span> code
        <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(<span class="comment">'/admin/blogengine/category/add/')</span>
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Create the <span class="keyword">new</span> category
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/category/add/', {</span>
            <span class="comment">'name': 'python',</span>
            <span class="comment">'description': 'The Python programming language'</span>
            },
            follow=<span class="literal">True</span>
        )
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check added successfully
        self.assertTrue(<span class="comment">'added successfully' in response.content)</span>

        # Check <span class="keyword">new</span> category <span class="built_in">now</span> <span class="keyword">in</span> database
        all_categories = Category.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_categories), <span class="number">1</span>)

    def test_edit_category(self):
        # Create the category
        category = Category()
        category.name = <span class="comment">'python'</span>
        category.description = <span class="comment">'The Python programming language'</span>
        category.save()

        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Edit the category
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/category/1/', {</span>
            <span class="comment">'name': 'perl',</span>
            <span class="comment">'description': 'The Perl programming language'</span>
            }, follow=<span class="literal">True</span>)
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check changed successfully
        self.assertTrue(<span class="comment">'changed successfully' in response.content)</span>

        # Check category amended
        all_categories = Category.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_categories), <span class="number">1</span>)
        only_category = all_categories[<span class="number">0</span>]
        self.assertEquals(only_category.name, <span class="comment">'perl')</span>
        self.assertEquals(only_category.description, <span class="comment">'The Perl programming language')</span>

    def test_delete_category(self):
        # Create the category
        category = Category()
        category.name = <span class="comment">'python'</span>
        category.description = <span class="comment">'The Python programming language'</span>
        category.save()

        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Delete the category
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/category/1/delete/', {</span>
            <span class="comment">'post': 'yes'</span>
        }, follow=<span class="literal">True</span>)
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check deleted successfully
        self.assertTrue(<span class="comment">'deleted successfully' in response.content)</span>

        # Check category deleted
        all_categories = Category.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_categories), <span class="number">0</span>)</code></pre>
<p>This is very similar to the prior code for the posts, and just checks we can create categories via the admin. We also need to check we can apply these categories to posts, and that they don&#39;t break the existing tests:</p>
<p>``` python blogengine/tests.py
    def test_create_post(self):</p>
<pre><code>    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # <span class="built_in">Log</span> <span class="keyword">in</span>
    self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

    # Check <span class="built_in">response</span> code
    <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(<span class="comment">'/admin/blogengine/post/add/')</span>
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Create the <span class="keyword">new</span> post
    <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/add/', {</span>
        <span class="comment">'title': 'My first post',</span>
        <span class="comment">'text': 'This is my first post',</span>
        <span class="comment">'pub_date_0': '2013-12-28',</span>
        <span class="comment">'pub_date_1': '22:00:04',</span>
        <span class="comment">'slug': 'my-first-post',</span>
        <span class="comment">'site': '1',</span>
        <span class="comment">'category': '1'</span>
    },
    follow=<span class="literal">True</span>
    )
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check added successfully
    self.assertTrue(<span class="comment">'added successfully' in response.content)</span>

    # Check <span class="keyword">new</span> post <span class="built_in">now</span> <span class="keyword">in</span> database
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

def test_edit_post(self):
    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is my first blog post'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.author = author
    post.site = site
    post.save()

    # <span class="built_in">Log</span> <span class="keyword">in</span>
    self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

    # Edit the post
    <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/1/', {</span>
        <span class="comment">'title': 'My second post',</span>
        <span class="comment">'text': 'This is my second blog post',</span>
        <span class="comment">'pub_date_0': '2013-12-28',</span>
        <span class="comment">'pub_date_1': '22:00:04',</span>
        <span class="comment">'slug': 'my-second-post',</span>
        <span class="comment">'site': '1',</span>
        <span class="comment">'category': '1'</span>
    },
    follow=<span class="literal">True</span>
    )
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check changed successfully
    self.assertTrue(<span class="comment">'changed successfully' in response.content)</span>

    # Check post amended
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)
    only_post = all_posts[<span class="number">0</span>]
    self.assertEquals(only_post.title, <span class="comment">'My second post')</span>
    self.assertEquals(only_post.text, <span class="comment">'This is my second blog post')</span>

def test_delete_post(self):
    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is my first blog post'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.site = site
    post.author = author
    post.category = category
    post.save()

    # Check <span class="keyword">new</span> post saved
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

    # <span class="built_in">Log</span> <span class="keyword">in</span>
    self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

    # Delete the post
    <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/1/delete/', {</span>
        <span class="comment">'post': 'yes'</span>
    }, follow=<span class="literal">True</span>)
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check deleted successfully
    self.assertTrue(<span class="comment">'deleted successfully' in response.content)</span>

    # Check post deleted
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">0</span>)</code></pre>
<pre><code>
Here we basically take our existing post tests <span class="keyword">in</span> the admin <span class="class"><span class="keyword">interface</span> <span class="title">and</span> <span class="title">add</span> <span class="title">the</span> <span class="title">category</span> <span class="title">to</span> <span class="title">them</span>. <span class="title">Finally</span>, <span class="title">we</span> <span class="title">edit</span> <span class="title">the</span> `<span class="title">PostViewTest</span>` <span class="title">class</span> <span class="title">to</span> <span class="title">include</span> <span class="title">categories</span>:

``` <span class="title">python</span> <span class="title">blogengine</span>/<span class="title">tests</span>.<span class="title">py</span>
<span class="title">class</span> <span class="title">PostViewTest</span>(<span class="title">BaseAcceptanceTest</span>):
    <span class="title">def</span> <span class="title">test_index</span>(<span class="title">self</span>):
        # <span class="title">Create</span> <span class="title">the</span> <span class="title">category</span>
        <span class="title">category</span> = <span class="title">Category</span>()
        <span class="title">category</span>.<span class="title">name</span> = '<span class="title">python</span>'
        <span class="title">category</span>.<span class="title">description</span> = '<span class="title">The</span> <span class="title">Python</span> <span class="title">programming</span> <span class="title">language</span>'
        <span class="title">category</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">author</span>
        <span class="title">author</span> = <span class="title">User</span>.<span class="title">objects</span>.<span class="title">create_user</span>('<span class="title">testuser</span>', '<span class="title">user</span>@<span class="title">example</span>.<span class="title">com</span>', '<span class="title">password</span>')
        <span class="title">author</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">site</span>
        <span class="title">site</span> = <span class="title">Site</span>()
        <span class="title">site</span>.<span class="title">name</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">domain</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">post</span>
        <span class="title">post</span> = <span class="title">Post</span>()
        <span class="title">post</span>.<span class="title">title</span> = '<span class="title">My</span> <span class="title">first</span> <span class="title">post</span>'
        <span class="title">post</span>.<span class="title">text</span> = '<span class="title">This</span> <span class="title">is</span> [<span class="title">my</span> <span class="title">first</span> <span class="title">blog</span> <span class="title">post</span>](<span class="title">http</span>://127.0.0.1:8000/)'
        <span class="title">post</span>.<span class="title">slug</span> = '<span class="title">my</span>-<span class="title">first</span>-<span class="title">post</span>'
        <span class="title">post</span>.<span class="title">pub_date</span> = <span class="title">timezone</span>.<span class="title">now</span>()
        <span class="title">post</span>.<span class="title">author</span> = <span class="title">author</span>
        <span class="title">post</span>.<span class="title">site</span> = <span class="title">site</span>
        <span class="title">post</span>.<span class="title">category</span> = <span class="title">category</span>
        <span class="title">post</span>.<span class="title">save</span>()

        # <span class="title">Check</span> <span class="title">new</span> <span class="title">post</span> <span class="title">saved</span>
        <span class="title">all_posts</span> = <span class="title">Post</span>.<span class="title">objects</span>.<span class="title">all</span>()
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">len</span>(<span class="title">all_posts</span>), 1)

        # <span class="title">Fetch</span> <span class="title">the</span> <span class="title">index</span>
        <span class="title">response</span> = <span class="title">self</span>.<span class="title">client</span>.<span class="title">get</span>('/')
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">response</span>.<span class="title">status_code</span>, 200)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">title</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">post</span>.<span class="title">title</span> <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">text</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">markdown</span>.<span class="title">markdown</span>(<span class="title">post</span>.<span class="title">text</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">date</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">str</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">year</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">strftime</span>('%<span class="title">b</span>') <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">str</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">day</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">link</span> <span class="title">is</span> <span class="title">marked</span> <span class="title">up</span> <span class="title">properly</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>('&lt;<span class="title">a</span> <span class="title">href</span>="<span class="title">http</span>://127.0.0.1:8000/"&gt;<span class="title">my</span> <span class="title">first</span> <span class="title">blog</span> <span class="title">post</span>&lt;/<span class="title">a</span>&gt;' <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

    <span class="title">def</span> <span class="title">test_post_page</span>(<span class="title">self</span>):
        # <span class="title">Create</span> <span class="title">the</span> <span class="title">category</span>
        <span class="title">category</span> = <span class="title">Category</span>()
        <span class="title">category</span>.<span class="title">name</span> = '<span class="title">python</span>'
        <span class="title">category</span>.<span class="title">description</span> = '<span class="title">The</span> <span class="title">Python</span> <span class="title">programming</span> <span class="title">language</span>'
        <span class="title">category</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">author</span>
        <span class="title">author</span> = <span class="title">User</span>.<span class="title">objects</span>.<span class="title">create_user</span>('<span class="title">testuser</span>', '<span class="title">user</span>@<span class="title">example</span>.<span class="title">com</span>', '<span class="title">password</span>')
        <span class="title">author</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">site</span>
        <span class="title">site</span> = <span class="title">Site</span>()
        <span class="title">site</span>.<span class="title">name</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">domain</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">post</span>
        <span class="title">post</span> = <span class="title">Post</span>()
        <span class="title">post</span>.<span class="title">title</span> = '<span class="title">My</span> <span class="title">first</span> <span class="title">post</span>'
        <span class="title">post</span>.<span class="title">text</span> = '<span class="title">This</span> <span class="title">is</span> [<span class="title">my</span> <span class="title">first</span> <span class="title">blog</span> <span class="title">post</span>](<span class="title">http</span>://127.0.0.1:8000/)'
        <span class="title">post</span>.<span class="title">slug</span> = '<span class="title">my</span>-<span class="title">first</span>-<span class="title">post</span>'
        <span class="title">post</span>.<span class="title">pub_date</span> = <span class="title">timezone</span>.<span class="title">now</span>()
        <span class="title">post</span>.<span class="title">author</span> = <span class="title">author</span>
        <span class="title">post</span>.<span class="title">site</span> = <span class="title">site</span>
        <span class="title">post</span>.<span class="title">category</span> = <span class="title">category</span>
        <span class="title">post</span>.<span class="title">save</span>()

        # <span class="title">Check</span> <span class="title">new</span> <span class="title">post</span> <span class="title">saved</span>
        <span class="title">all_posts</span> = <span class="title">Post</span>.<span class="title">objects</span>.<span class="title">all</span>()
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">len</span>(<span class="title">all_posts</span>), 1)
        <span class="title">only_post</span> = <span class="title">all_posts</span>[0]
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">only_post</span>, <span class="title">post</span>)

        # <span class="title">Get</span> <span class="title">the</span> <span class="title">post</span> <span class="title">URL</span>
        <span class="title">post_url</span> = <span class="title">only_post</span>.<span class="title">get_absolute_url</span>()

        # <span class="title">Fetch</span> <span class="title">the</span> <span class="title">post</span>
        <span class="title">response</span> = <span class="title">self</span>.<span class="title">client</span>.<span class="title">get</span>(<span class="title">post_url</span>)
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">response</span>.<span class="title">status_code</span>, 200)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">title</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">post</span>.<span class="title">title</span> <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">text</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">markdown</span>.<span class="title">markdown</span>(<span class="title">post</span>.<span class="title">text</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">post</span> <span class="title">date</span> <span class="title">is</span> <span class="title">in</span> <span class="title">the</span> <span class="title">response</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">str</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">year</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">strftime</span>('%<span class="title">b</span>') <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)
        <span class="title">self</span>.<span class="title">assertTrue</span>(<span class="title">str</span>(<span class="title">post</span>.<span class="title">pub_date</span>.<span class="title">day</span>) <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">the</span> <span class="title">link</span> <span class="title">is</span> <span class="title">marked</span> <span class="title">up</span> <span class="title">properly</span>
        <span class="title">self</span>.<span class="title">assertTrue</span>('&lt;<span class="title">a</span> <span class="title">href</span>="<span class="title">http</span>://127.0.0.1:8000/"&gt;<span class="title">my</span> <span class="title">first</span> <span class="title">blog</span> <span class="title">post</span>&lt;/<span class="title">a</span>&gt;' <span class="title">in</span> <span class="title">response</span>.<span class="title">content</span>)</code></pre>
<p>Now it&#39;s time to run our tests:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
E
======================================================================
ERROR: blogengine.tests (unittest.loader.ModuleImportFailure)
----------------------------------------------------------------------
ImportError: Failed to import test module: blogengine.tests
Traceback (most recent call last):
  File <span class="string">"/usr/local/Cellar/python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/loader.py"</span>, line 254, <span class="keyword">in</span> _find_tests
    module = self._get_module_from_name(name)
  File <span class="string">"/usr/local/Cellar/python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/loader.py"</span>, line 232, <span class="keyword">in</span> _get_module_from_name
    __import__(name)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 3, <span class="keyword">in</span> &lt;module&gt;
    from blogengine.models import Post, Category
ImportError: cannot import name Category


----------------------------------------------------------------------
Ran 1 test <span class="keyword">in</span> 0.000s

FAILED (errors=1)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>This is the expected result. We need to create our Category model. So let&#39;s do that:</p>
<p>``` python blogengine/models.py
from django.db import models
from django.contrib.auth.models import User
from django.contrib.sites.models import Site</p>
<h1 id="create-your-models-here-">Create your models here.</h1>
<p>class Category(models.Model):
    name = models.CharField(max_length=200)
    description = models.TextField()</p>
<p>class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField()
    text = models.TextField()
    slug = models.SlugField(max_length=40, unique=True)
    author = models.ForeignKey(User)
    site = models.ForeignKey(Site)
    category = models.ForeignKey(Category, blank=True, null=True)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> <span class="string">"/%s/%s/%s/"</span> % (self.pub_date.year, self.pub_date.month, self.slug)

<span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.title

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    ordering = [<span class="string">"-pub_date"</span>]</code></pre>
<pre><code>
<span class="comment">Note</span> <span class="comment">that</span> <span class="comment">we</span> <span class="comment">add</span> <span class="comment">`Category`</span> <span class="comment">before</span> <span class="comment">`Post`</span> <span class="literal">-</span> <span class="comment">this</span> <span class="comment">is</span> <span class="comment">because</span> <span class="comment">`Category`</span> <span class="comment">is</span> <span class="comment">a</span> <span class="comment">foreign</span> <span class="comment">key</span> <span class="comment">in</span> <span class="comment">`Post`</span>, <span class="comment">and</span> <span class="comment">must</span> <span class="comment">be</span> <span class="comment">defined</span> <span class="comment">in</span> <span class="comment">order</span> <span class="comment">to</span> <span class="comment">be</span> <span class="comment">used</span>. <span class="comment">Also</span>, <span class="comment">note</span> <span class="comment">that</span> <span class="comment">we</span> <span class="comment">add</span> <span class="comment">the</span> <span class="comment">`category`</span> <span class="comment">attribute</span> <span class="comment">as</span> <span class="comment">a</span> <span class="comment">`ForeignKey`</span> <span class="comment">field</span>, <span class="comment">like</span> <span class="comment">`User`</span> <span class="comment">and</span> <span class="comment">`Site`</span>, <span class="comment">indicating</span> <span class="comment">that</span> <span class="comment">it</span> <span class="comment">is</span> <span class="comment">an</span> <span class="comment">item</span> <span class="comment">in</span> <span class="comment">another</span> <span class="comment">table</span> <span class="comment">being</span> <span class="comment">references</span>.

<span class="comment">We</span> <span class="comment">also</span> <span class="comment">allow</span> <span class="comment">for</span> <span class="comment">`category`</span> <span class="comment">to</span> <span class="comment">be</span> <span class="comment">blank</span> <span class="comment">or</span> <span class="comment">null</span>, <span class="comment">so</span> <span class="comment">the</span> <span class="comment">user</span> <span class="comment">does</span> <span class="comment">not</span> <span class="comment">have</span> <span class="comment">to</span> <span class="comment">apply</span> <span class="comment">a</span> <span class="comment">category</span> <span class="comment">if</span> <span class="comment">they</span> <span class="comment">don't</span> <span class="comment">wish</span> <span class="comment">to</span>.

<span class="comment">If</span> <span class="comment">we</span> <span class="comment">run</span> <span class="comment">our</span> <span class="comment">tests</span>, <span class="comment">they</span> <span class="comment">should</span> <span class="comment">still</span> <span class="comment">fail:</span>

<span class="comment">```</span> <span class="comment">bash</span>
<span class="comment">(venv)Smith:django_tutorial_blog_ng</span> <span class="comment">matthewdaly$</span> <span class="comment">python</span> <span class="comment">manage</span>.<span class="comment">py</span> <span class="comment">test</span> <span class="comment">blogengine</span>
<span class="comment">Creating</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span>
<span class="comment">EEFEEEEE</span>.<span class="string">.</span><span class="string">.</span><span class="comment">EE</span>
<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_create_category</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">PostTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">20</span>, <span class="comment">in</span> <span class="comment">test_create_category</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_create_post</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">PostTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">37</span>, <span class="comment">in</span> <span class="comment">test_create_post</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_create_post</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">215</span>, <span class="comment">in</span> <span class="comment">test_create_post</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_delete_category</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">192</span>, <span class="comment">in</span> <span class="comment">test_delete_category</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_delete_post</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">304</span>, <span class="comment">in</span> <span class="comment">test_delete_post</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_edit_category</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">165</span>, <span class="comment">in</span> <span class="comment">test_edit_category</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_edit_post</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">250</span>, <span class="comment">in</span> <span class="comment">test_edit_post</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_index</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">PostViewTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">353</span>, <span class="comment">in</span> <span class="comment">test_index</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">ERROR:</span> <span class="comment">test_post_page</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">PostViewTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">403</span>, <span class="comment">in</span> <span class="comment">test_post_page</span>
    <span class="comment">category</span>.<span class="comment">save()</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">545</span>, <span class="comment">in</span> <span class="comment">save</span>
    <span class="comment">force_update=force_update</span>, <span class="comment">update_fields=update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">573</span>, <span class="comment">in</span> <span class="comment">save_base</span>
    <span class="comment">updated</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_save_table(raw</span>, <span class="comment">cls</span>, <span class="comment">force_insert</span>, <span class="comment">force_update</span>, <span class="comment">using</span>, <span class="comment">update_fields)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">654</span>, <span class="comment">in</span> <span class="comment">_save_table</span>
    <span class="comment">result</span> <span class="comment">=</span> <span class="comment">self</span>.<span class="comment">_do_insert(cls</span>.<span class="comment">_base_manager</span>, <span class="comment">using</span>, <span class="comment">fields</span>, <span class="comment">update_pk</span>, <span class="comment">raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">687</span>, <span class="comment">in</span> <span class="comment">_do_insert</span>
    <span class="comment">using=using</span>, <span class="comment">raw=raw)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/manager</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">232</span>, <span class="comment">in</span> <span class="comment">_insert</span>
    <span class="comment">return</span> <span class="comment">insert_query(self</span>.<span class="comment">model</span>, <span class="comment">objs</span>, <span class="comment">fields</span>, <span class="comment">**kwargs)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/query</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">1511</span>, <span class="comment">in</span> <span class="comment">insert_query</span>
    <span class="comment">return</span> <span class="comment">query</span>.<span class="comment">get_compiler(using=using)</span>.<span class="comment">execute_sql(return_id)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/models/sql/compiler</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">898</span>, <span class="comment">in</span> <span class="comment">execute_sql</span>
    <span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/utils</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">99</span>, <span class="comment">in</span> <span class="comment">__exit__</span>
    <span class="comment">six</span>.<span class="comment">reraise(dj_exc_type</span>, <span class="comment">dj_exc_value</span>, <span class="comment">traceback)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/util</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">53</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">self</span>.<span class="comment">cursor</span>.<span class="comment">execute(sql</span>, <span class="comment">params)</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2</span>.<span class="comment">7/site</span>-<span class="comment">packages/django/db/backends/sqlite3/base</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">450</span>, <span class="comment">in</span> <span class="comment">execute</span>
    <span class="comment">return</span> <span class="comment">Database</span>.<span class="comment">Cursor</span>.<span class="comment">execute(self</span>, <span class="comment">query</span>, <span class="comment">params)</span>
<span class="comment">OperationalError:</span> <span class="comment">no</span> <span class="comment">such</span> <span class="comment">table:</span> <span class="comment">blogengine_category</span>

<span class="comment">======================================================================</span>
<span class="comment">FAIL:</span> <span class="comment">test_create_category</span> <span class="comment">(blogengine</span>.<span class="comment">tests</span>.<span class="comment">AdminTest)</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Traceback</span> <span class="comment">(most</span> <span class="comment">recent</span> <span class="comment">call</span> <span class="comment">last):</span>
  <span class="comment">File</span> <span class="comment">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests</span>.<span class="comment">py"</span>, <span class="comment">line</span> <span class="comment">142</span>, <span class="comment">in</span> <span class="comment">test_create_category</span>
    <span class="comment">self</span>.<span class="comment">assertEquals(response</span>.<span class="comment">status_code</span>, <span class="comment">200)</span>
<span class="comment">AssertionError:</span> <span class="comment">404</span> <span class="comment">!=</span> <span class="comment">200</span>

<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Ran</span> <span class="comment">13</span> <span class="comment">tests</span> <span class="comment">in</span> <span class="comment">3</span>.<span class="comment">393s</span>

<span class="comment">FAILED</span> <span class="comment">(failures=1</span>, <span class="comment">errors=9)</span>
<span class="comment">Destroying</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span></code></pre>
<p>The category table hasn&#39;t yet been created, so we need to use South to create and run the migrations:</p>
<pre><code class="lang-bash">python manage.py schemamigration --auto blogengine
python manage.py migrate</code></pre>
<p>If we then run our tests again, some of them will still fail:</p>
<pre><code class="lang-bash">Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
..F.F.F......
======================================================================
FAIL: test_create_category (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 142, <span class="keyword">in</span> test_create_category
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

======================================================================
FAIL: test_delete_category (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 201, <span class="keyword">in</span> test_delete_category
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

======================================================================
FAIL: test_edit_category (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 175, <span class="keyword">in</span> test_edit_category
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 13 tests <span class="keyword">in</span> 4.047s

FAILED (failures=3)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>That&#39;s because we haven&#39;t registered the categories in the admin. So, that&#39;s our next job:</p>
<p>``` python blogengine/admin.py
import models
from django.contrib import admin
from django.contrib.auth.models import User</p>
<p>class PostAdmin(admin.ModelAdmin):
    prepopulated_fields = {&quot;slug&quot;: (&quot;title&quot;,)}
    exclude = (&#39;author&#39;,)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">save_model</span><span class="params">(self, request, obj, form, change)</span>:</span>
    obj.author = request.user
    obj.save()</code></pre>
<p>admin.site.register(models.Category)
admin.site.register(models.Post, PostAdmin)</p>
<pre><code>
<span class="comment">Now</span> <span class="comment">we</span> <span class="comment">try</span> <span class="comment">again:</span>

<span class="comment">```</span> <span class="comment">bash</span>
<span class="comment">(venv)Smith:django_tutorial_blog_ng</span> <span class="comment">matthewdaly$</span> <span class="comment">python</span> <span class="comment">manage</span>.<span class="comment">py</span> <span class="comment">test</span> <span class="comment">blogengine</span>
<span class="comment">Creating</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span>
<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Ran</span> <span class="comment">13</span> <span class="comment">tests</span> <span class="comment">in</span> <span class="comment">4</span>.<span class="comment">092s</span>

<span class="comment">OK</span>
<span class="comment">Destroying</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span></code></pre>
<p>It passes! Let&#39;s do a quick sense check before committing. Run the server:</p>
<pre><code class="lang-bash">python manage.py runserver</code></pre>
<p>If you visit the <a href="http://127.0.0.1:8000/admin/">admin</a>, you&#39;ll see the text for category is <code>Categorys</code>, which is incorrect. We also don&#39;t have a good representation of the category in the admin. Let&#39;s fix that:</p>
<p>``` python blogengine/models.py
from django.db import models
from django.contrib.auth.models import User
from django.contrib.sites.models import Site</p>
<h1 id="create-your-models-here-">Create your models here.</h1>
<p>class Category(models.Model):
    name = models.CharField(max_length=200)
    description = models.TextField()</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.name

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    verbose_name_plural = <span class="string">'categories'</span></code></pre>
<p>class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField()
    text = models.TextField()
    slug = models.SlugField(max_length=40, unique=True)
    author = models.ForeignKey(User)
    site = models.ForeignKey(Site)
    category = models.ForeignKey(Category, blank=True, null=True)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> <span class="string">"/%s/%s/%s/"</span> % (self.pub_date.year, self.pub_date.month, self.slug)

<span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.title

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    ordering = [<span class="string">"-pub_date"</span>]</code></pre>
<pre><code>
Let's <span class="operator"><span class="keyword">commit</span> our changes:

<span class="string">``</span><span class="string">` bash
git add blogengine/
git commit -m 'Implemented categories'</code></pre>
<p>Now, as yet our categories don&#39;t actually do all that much. We would like to be able to:</p>
<ul>
<li>List all posts under a category</li>
<li>Show the post category at the base of the post</li>
</ul>
<p>So, let&#39;s implement that. First, as usual, we implement tests first:</p>
<p>``` python blogengine/tests.py
class PostViewTest(BaseAcceptanceTest):
    def test_index(self):</p>
<pre><code>    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is [my first blog post](http://127.0.0.1:8000/)'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.author = author
    post.site = site
    post.category = category
    post.save()

    # Check <span class="keyword">new</span> post saved
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

    # Fetch the index
    <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(<span class="comment">'/')</span>
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check the post title <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.title <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post text <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(markdown.markdown(post.text) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post category <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.category.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post <span class="built_in">date</span> <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">year</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)
    self.assertTrue(post.pub_date.strftime(<span class="comment">'%b') in response.content)</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">day</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the link <span class="keyword">is</span> marked up properly
    self.assertTrue(<span class="comment">'&lt;a href="http://127.0.0.1:8000/"&gt;my first blog post&lt;/a&gt;' in response.content)</span>

def test_post_page(self):
    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is [my first blog post](http://127.0.0.1:8000/)'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.author = author
    post.site = site
    post.category = category
    post.save()

    # Check <span class="keyword">new</span> post saved
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)
    only_post = all_posts[<span class="number">0</span>]
    self.assertEquals(only_post, post)

    # <span class="keyword">Get</span> the post URL
    post_url = only_post.get_absolute_url()

    # Fetch the post
    <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(post_url)
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check the post title <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.title <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post category <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.category.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post text <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(markdown.markdown(post.text) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post <span class="built_in">date</span> <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">year</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)
    self.assertTrue(post.pub_date.strftime(<span class="comment">'%b') in response.content)</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">day</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the link <span class="keyword">is</span> marked up properly
    self.assertTrue(<span class="comment">'&lt;a href="http://127.0.0.1:8000/"&gt;my first blog post&lt;/a&gt;' in response.content)</span></code></pre>
<pre><code>
All we do here <span class="keyword">is</span> assert <span class="keyword">that</span> <span class="keyword">for</span> both <span class="keyword">the</span> post pages <span class="keyword">and</span> <span class="keyword">the</span> index, <span class="keyword">the</span> <span class="type">text</span> <span class="keyword">from</span> <span class="keyword">the</span> category <span class="property">name</span> <span class="keyword">is</span> shown <span class="keyword">in</span> <span class="keyword">the</span> response. We also need <span class="keyword">to</span> check <span class="keyword">the</span> category-specific route works. Add this method <span class="keyword">to</span> `PostViewTest`:

``` python blogengine/tests.py
    def test_category_page(self):
        <span class="comment"># Create the category</span>
        category = Category()
        category.<span class="property">name</span> = 'python'
        category.description = 'The Python programming language'
        category.save()

        <span class="comment"># Create the author</span>
        author = User.objects.create_user('testuser', 'user@example.com', 'password')
        author.save()

        <span class="comment"># Create the site</span>
        site = Site()
        site.<span class="property">name</span> = 'example.com'
        site.domain = 'example.com'
        site.save()

        <span class="comment"># Create the post</span>
        post = Post()
        post.title = 'My <span class="keyword">first</span> post'
        post.<span class="type">text</span> = 'This <span class="keyword">is</span> [<span class="keyword">my</span> <span class="keyword">first</span> blog post](http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span>/)'
        post.slug = '<span class="keyword">my</span>-<span class="keyword">first</span>-post'
        post.pub_date = timezone.now()
        post.author = author
        post.site = site
        post.category = category
        post.save()

        <span class="comment"># Check new post saved</span>
        all_posts = Post.objects.all()
        self.assertEquals(len(all_posts), <span class="number">1</span>)
        only_post = all_posts[<span class="number">0</span>]
        self.assertEquals(only_post, post)

        <span class="comment"># Get the category URL</span>
        category_url = post.category.get_absolute_url()

        <span class="comment"># Fetch the category</span>
        response = self.client.<span class="keyword">get</span>(category_url)
        self.assertEquals(response.status_code, <span class="number">200</span>)

        <span class="comment"># Check the category name is in the response</span>
        self.assertTrue(post.category.<span class="property">name</span> <span class="keyword">in</span> response.content)

        <span class="comment"># Check the post text is in the response</span>
        self.assertTrue(markdown.markdown(post.<span class="type">text</span>) <span class="keyword">in</span> response.content)

        <span class="comment"># Check the post date is in the response</span>
        self.assertTrue(str(post.pub_date.<span class="property">year</span>) <span class="keyword">in</span> response.content)
        self.assertTrue(post.pub_date.strftime('%b') <span class="keyword">in</span> response.content)
        self.assertTrue(str(post.pub_date.<span class="property">day</span>) <span class="keyword">in</span> response.content)

        <span class="comment"># Check the link is marked up properly</span>
        self.assertTrue('&lt;a href=<span class="string">"http://127.0.0.1:8000/"</span>&gt;<span class="keyword">my</span> <span class="keyword">first</span> blog post&lt;/a&gt;' <span class="keyword">in</span> response.content)</code></pre>
<p>This is very similar to the previous tests, but fetches the absolute URL for the category, and ensures the category name and post content are shown. Now, let&#39;s run our new tests:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
...........EFF
======================================================================
ERROR: test_category_page (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 494, <span class="keyword">in</span> test_category_page
    category_url = post.category.get_absolute_url()
AttributeError: <span class="string">'Category'</span> object has no attribute <span class="string">'get_absolute_url'</span>

======================================================================
FAIL: test_index (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 391, <span class="keyword">in</span> test_index
    self.assertTrue(post.category.name <span class="keyword">in</span> response.content)
AssertionError: False is not <span class="literal">true</span>

======================================================================
FAIL: test_post_page (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 446, <span class="keyword">in</span> test_post_page
    self.assertTrue(post.category.name <span class="keyword">in</span> response.content)
AssertionError: False is not <span class="literal">true</span>

----------------------------------------------------------------------
Ran 14 tests <span class="keyword">in</span> 5.017s

FAILED (failures=2, errors=1)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>Let&#39;s take a look at why they failed. <code>test_category_page</code> failed because the <code>Category</code> object had no method <code>get_absolute_url</code>. So we need to implement one. To do so, we really need to add a slug field, like the posts already have. Ideally, we want this to be populated automatically, but with the option to create one manually. So, edit the models as follows:</p>
<p>``` python blogengine/models.py
from django.db import models
from django.contrib.auth.models import User
from django.contrib.sites.models import Site
from django.utils.text import slugify</p>
<h1 id="create-your-models-here-">Create your models here.</h1>
<p>class Category(models.Model):
    name = models.CharField(max_length=200)
    description = models.TextField()
    slug = models.SlugField(max_length=40, unique=True, blank=True, null=True)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self)</span>:</span>
    <span class="keyword">if</span> <span class="keyword">not</span> self.slug:
        self.slug = slugify(unicode(self.name))
    super(Category, self).save()

<span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> <span class="string">"/category/%s/"</span> % (self.slug)

<span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.name

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    verbose_name_plural = <span class="string">'categories'</span></code></pre>
<p>class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField()
    text = models.TextField()
    slug = models.SlugField(max_length=40, unique=True)
    author = models.ForeignKey(User)
    site = models.ForeignKey(Site)
    category = models.ForeignKey(Category, blank=True, null=True)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> <span class="string">"/%s/%s/%s/"</span> % (self.pub_date.year, self.pub_date.month, self.slug)

<span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.title

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    ordering = [<span class="string">"-pub_date"</span>]</code></pre>
<pre><code>
We're adding <span class="keyword">the</span> `slug` attribute <span class="keyword">to</span> <span class="keyword">the</span> `Category` model here. However, we're also overriding <span class="keyword">the</span> `save` method <span class="keyword">to</span> detect <span class="keyword">if</span> <span class="keyword">the</span> slug <span class="keyword">is</span> <span class="keyword">set</span>, <span class="keyword">and</span> <span class="keyword">if</span> <span class="keyword">not</span>, <span class="keyword">to</span> create a slug using <span class="keyword">the</span> `slugify` function, <span class="keyword">and</span> <span class="keyword">set</span> <span class="keyword">it</span> <span class="keyword">as</span> <span class="keyword">the</span> category's slug. We also define an absolute URL <span class="keyword">for</span> <span class="keyword">the</span> category.

Now, <span class="keyword">if</span> you <span class="command">run</span> <span class="keyword">the</span> tests, they will fail because we haven't made <span class="keyword">the</span> changes <span class="keyword">to</span> <span class="keyword">the</span> database. So, we use South again:

``` bash
python manage.py schemamigration <span class="comment">--auto blogengine</span></code></pre>
<p>Then run the migration:</p>
<pre><code class="lang-bash">python manage.py migrate</code></pre>
<p>Now, running our tests will show that the tables are in place, but we still have some work to do. The index and post pages don&#39;t show our categories, so we&#39;ll fix that. First, we&#39;ll fix our post list:</p>
<p>``` html templates/blogengine/post_list.html
{% raw %}{% extends &quot;blogengine/includes/base.html&quot; %}</p>
<pre><code><span class="template_tag">{% <span class="keyword">load</span> custom_markdown %}</span>

<span class="template_tag">{% <span class="keyword">block</span> content %}</span>
    <span class="template_tag">{% <span class="keyword">for</span> post <span class="keyword">in</span> object_list %}</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"post"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h1</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ post.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ post.title }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h3</span>&gt;</span><span class="variable">{{ post.pub_date }}</span><span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
    <span class="variable">{{ post.text<span class="filter">|custom</span>_markdown }}</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ post.category.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ post.category.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endfor</span> %}</span>

    <span class="template_tag">{% <span class="keyword">if</span> page_obj.has_previous %}</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/<span class="variable">{{ page_obj.previous_page_number }}</span>/"</span>&gt;</span>Previous Page<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endif</span> %}</span>
    <span class="template_tag">{% <span class="keyword">if</span> page_obj.has_next %}</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/<span class="variable">{{ page_obj.next_page_number }}</span>/"</span>&gt;</span>Next Page<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endif</span> %}</span>

<span class="template_tag">{% <span class="keyword">endblock</span> %}</span><span class="template_tag">{% endraw %}</span></code></pre>
<pre><code>
Next, we'll take care of our post detail page:

``` html templates/blogengine/post_detail.html
<span class="template_tag">{% raw %}</span><span class="template_tag">{% <span class="keyword">extends</span> "blogengine/includes/base.html" %}</span>

    <span class="template_tag">{% <span class="keyword">load</span> custom_markdown %}</span>

    <span class="template_tag">{% <span class="keyword">block</span> content %}</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"post"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">h1</span>&gt;</span><span class="variable">{{ object.title }}</span><span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
        <span class="tag">&lt;<span class="title">h3</span>&gt;</span><span class="variable">{{ object.pub_date }}</span><span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
        <span class="variable">{{ object.text<span class="filter">|custom</span>_markdown }}</span>
        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ object.category.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ object.category.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>

        <span class="tag">&lt;<span class="title">h4</span>&gt;</span>Comments<span class="tag">&lt;/<span class="title">h4</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"fb-comments"</span> <span class="attribute">data-href</span>=<span class="value">"http://<span class="variable">{{ post.site }}</span><span class="variable">{{ post.get_absolute_url }}</span>"</span> <span class="attribute">data-width</span>=<span class="value">"470"</span> <span class="attribute">data-num-posts</span>=<span class="value">"10"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>

        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

    <span class="template_tag">{% <span class="keyword">endblock</span> %}</span><span class="template_tag">{% endraw %}</span></code></pre>
<p>Note that in both cases we include a link to the category URL.</p>
<p>Now, we should only have one failing test outstanding - the category page. For this, generic views aren&#39;t sufficient as we need to limit the queryset to only show those posts with a specific category. Fortunately, we can extend Django&#39;s generic views to add this functionality. First, we edit our URLconfs:</p>
<p>``` python blogengine/urls.py
from django.conf.urls import patterns, url
from django.views.generic import ListView, DetailView
from blogengine.models import Post, Category
from blogengine.views import CategoryListView</p>
<p>urlpatterns = patterns(&#39;&#39;,</p>
<pre><code><span class="comment"># Index</span>
url(<span class="string">r'^(?P&lt;page&gt;\d+)?/?$'</span>, ListView.as_view(
    model=Post,
    paginate_by=<span class="number">5</span>,
    )),

<span class="comment"># Individual posts</span>
url(<span class="string">r'^(?P&lt;pub_date__year&gt;\d{4})/(?P&lt;pub_date__month&gt;\d{1,2})/(?P&lt;slug&gt;[a-zA-Z0-9-]+)/?$'</span>, DetailView.as_view(
    model=Post,
    )),

<span class="comment"># Categories</span>
url(<span class="string">r'^category/(?P&lt;slug&gt;[a-zA-Z0-9-]+)/?$'</span>, CategoryListView.as_view(
    paginate_by=<span class="number">5</span>,
    model=Category,
    )),</code></pre>
<p>)</p>
<pre><code>
Note we <span class="keyword">import</span> a new view <span class="keyword">from</span> `blogengine.views` called `CategoryListView`. Next, we create that listview:

``` python blogengine/views.py
<span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render
<span class="keyword">from</span> django.views.generic <span class="keyword">import</span> ListView
<span class="keyword">from</span> blogengine.models <span class="keyword">import</span> Category, Post

<span class="comment"># Create your views here.</span>
<span class="class"><span class="keyword">class</span> <span class="title">CategoryListView</span><span class="params">(ListView)</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span>
        slug = self.kwargs[<span class="string">'slug'</span>]
        <span class="keyword">try</span>:
            category = Category.objects.get(slug=slug)
            <span class="keyword">return</span> Post.objects.filter(category=category)
        <span class="keyword">except</span> Category.DoesNotExist:
            <span class="keyword">return</span> Post.objects.none()</code></pre>
<p>This is quite simple. We import the <code>ListView</code>, as well as our models. Then we extend <code>ListView</code> by getting the slug from the request, fetching the appropriate category, and returning only those posts that have that category. If the category does not exist, we return the empty <code>Post</code> object list. We haven&#39;t had to set the template manually as it is inherited from <code>ListView</code>.</p>
<p>If you run the tests, they should now pass:</p>
<pre><code class="lang-bash">Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
..............
----------------------------------------------------------------------
Ran 14 tests <span class="keyword">in</span> 5.083s

OK
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>So let&#39;s commit our changes:</p>
<pre><code class="lang-bash">git add blogengine/ templates/
git commit -m <span class="string">'Categories are now shown'</span></code></pre>
<h2 id="tags">Tags</h2>
<p>Tags are fairly similar to categories, but more complex. The relationship they have is called <em>many-to-many</em> - in other words, a tag can be applied to many posts, and one post can have many tags. This is more difficult to model with a relational database. The usual way to do so is to create an intermediate table between the posts and tags, to identify mappings between the two. Fortunately, Django makes this quite easy.</p>
<p>Let&#39;s write the tests for our tagging system. As with the categories, we&#39;ll write the tests for creating and editing them first, and add in tests for them being visible later. First we&#39;ll create a test for creating a new tag object:</p>
<p>``` python blogengine/tests.py
    def test_create_tag(self):</p>
<pre><code>    <span class="comment"># Create the tag</span>
    tag = <span class="constant">Tag</span>()

    <span class="comment"># Add attributes</span>
    tag.name = <span class="string">'python'</span>
    tag.description = <span class="string">'The Python programming language'</span>

    <span class="comment"># Save it</span>
    tag.save()

    <span class="comment"># Check we can find it</span>
    all_tags = <span class="constant">Tag</span>.objects.all()
    <span class="keyword">self</span>.assertEquals(len(all_tags), <span class="number">1</span>)
    only_tag = all_tags[<span class="number">0</span>]
    <span class="keyword">self</span>.assertEquals(only_tag, tag)

    <span class="comment"># Check attributes</span>
    <span class="keyword">self</span>.assertEquals(only_tag.name, <span class="string">'python'</span>)
    <span class="keyword">self</span>.assertEquals(only_tag.description, <span class="string">'The Python programming language'</span>)</code></pre>
<pre><code>
Next, we'll amend <span class="keyword">the</span> test <span class="keyword">for</span> creating a post <span class="keyword">to</span> include tags:


``` python blogengine/tests.py
    def test_create_post(self):
        <span class="comment"># Create the category</span>
        category = Category()
        category.<span class="property">name</span> = 'python'
        category.description = 'The Python programming language'
        category.save()

        <span class="comment"># Create the tag</span>
        tag = Tag()
        tag.<span class="property">name</span> = 'python'
        tag.description = 'The Python programming language'
        tag.save()

        <span class="comment"># Create the author</span>
        author = User.objects.create_user('testuser', 'user@example.com', 'password')
        author.save()

        <span class="comment"># Create the site</span>
        site = Site()
        site.<span class="property">name</span> = 'example.com'
        site.domain = 'example.com'
        site.save()

        <span class="comment"># Create the post</span>
        post = Post()

        <span class="comment"># Set the attributes</span>
        post.title = 'My <span class="keyword">first</span> post'
        post.<span class="type">text</span> = 'This <span class="keyword">is</span> <span class="keyword">my</span> <span class="keyword">first</span> blog post'
        post.slug = '<span class="keyword">my</span>-<span class="keyword">first</span>-post'
        post.pub_date = timezone.now()
        post.author = author
        post.site = site
        post.category = category

        <span class="comment"># Save it</span>
        post.save()

        <span class="comment"># Add the tag</span>
        post.tags.add(tag)
        post.save()

        <span class="comment"># Check we can find it</span>
        all_posts = Post.objects.all()
        self.assertEquals(len(all_posts), <span class="number">1</span>)
        only_post = all_posts[<span class="number">0</span>]
        self.assertEquals(only_post, post)

        <span class="comment"># Check attributes</span>
        self.assertEquals(only_post.title, 'My <span class="keyword">first</span> post')
        self.assertEquals(only_post.<span class="type">text</span>, 'This <span class="keyword">is</span> <span class="keyword">my</span> <span class="keyword">first</span> blog post')
        self.assertEquals(only_post.slug, '<span class="keyword">my</span>-<span class="keyword">first</span>-post')
        self.assertEquals(only_post.site.<span class="property">name</span>, 'example.com')
        self.assertEquals(only_post.site.domain, 'example.com')
        self.assertEquals(only_post.pub_date.<span class="property">day</span>, post.pub_date.<span class="property">day</span>)
        self.assertEquals(only_post.pub_date.<span class="property">month</span>, post.pub_date.<span class="property">month</span>)
        self.assertEquals(only_post.pub_date.<span class="property">year</span>, post.pub_date.<span class="property">year</span>)
        self.assertEquals(only_post.pub_date.hour, post.pub_date.hour)
        self.assertEquals(only_post.pub_date.minute, post.pub_date.minute)
        self.assertEquals(only_post.pub_date.<span class="keyword">second</span>, post.pub_date.<span class="keyword">second</span>)
        self.assertEquals(only_post.author.username, 'testuser')
        self.assertEquals(only_post.author.email, 'user@example.com')
        self.assertEquals(only_post.category.<span class="property">name</span>, 'python')
        self.assertEquals(only_post.category.description, 'The Python programming language')

        <span class="comment"># Check tags</span>
        post_tags = only_post.tags.all()
        self.assertEquals(len(post_tags), <span class="number">1</span>)
        only_post_tag = post_tags[<span class="number">0</span>]
        self.assertEquals(only_post_tag, tag)
        self.assertEquals(only_post_tag.<span class="property">name</span>, 'python')
        self.assertEquals(only_post_tag.description, 'The Python programming language')</code></pre>
<p>Note the difference in how we apply the tags. Because a post can have more than one tag, we can&#39;t just define <code>post.tag</code> in the same way. Instead, we have <code>post.tags</code>, which you can think of as a list, and we use the <code>add</code> method to add a new tag. Note also that the post must already exist before we can add a tag.</p>
<p>We also need to create acceptance tests for creating, editing and deleting tags:</p>
<p>``` python blogengine/tests.py
    def test_create_tag(self):</p>
<pre><code>    <span class="comment"># Log in</span>
    <span class="keyword">self</span>.client.login(username=<span class="string">'bobsmith'</span>, password=<span class="string">"password"</span>)

    <span class="comment"># Check response code</span>
    response = <span class="keyword">self</span>.client.get(<span class="string">'/admin/blogengine/tag/add/'</span>)
    <span class="keyword">self</span>.assertEquals(response.status_code, <span class="number">200</span>)

    <span class="comment"># Create the new tag</span>
    response = <span class="keyword">self</span>.client.post(<span class="string">'/admin/blogengine/tag/add/'</span>, {
        <span class="string">'name'</span><span class="symbol">:</span> <span class="string">'python'</span>,
        <span class="string">'description'</span><span class="symbol">:</span> <span class="string">'The Python programming language'</span>
        },
        follow=<span class="constant">True</span>
    )
    <span class="keyword">self</span>.assertEquals(response.status_code, <span class="number">200</span>)

    <span class="comment"># Check added successfully</span>
    <span class="keyword">self</span>.assertTrue(<span class="string">'added successfully'</span> <span class="keyword">in</span> response.content)

    <span class="comment"># Check new tag now in database</span>
    all_tags = <span class="constant">Tag</span>.objects.all()
    <span class="keyword">self</span>.assertEquals(len(all_tags), <span class="number">1</span>)

<span class="function"><span class="keyword">def</span> <span class="title">test_edit_tag</span><span class="params">(<span class="keyword">self</span>)</span>:</span>
    <span class="comment"># Create the tag</span>
    tag = <span class="constant">Tag</span>()
    tag.name = <span class="string">'python'</span>
    tag.description = <span class="string">'The Python programming language'</span>
    tag.save()

    <span class="comment"># Log in</span>
    <span class="keyword">self</span>.client.login(username=<span class="string">'bobsmith'</span>, password=<span class="string">"password"</span>)

    <span class="comment"># Edit the tag</span>
    response = <span class="keyword">self</span>.client.post(<span class="string">'/admin/blogengine/tag/1/'</span>, {
        <span class="string">'name'</span><span class="symbol">:</span> <span class="string">'perl'</span>,
        <span class="string">'description'</span><span class="symbol">:</span> <span class="string">'The Perl programming language'</span>
        }, follow=<span class="constant">True</span>)
    <span class="keyword">self</span>.assertEquals(response.status_code, <span class="number">200</span>)

    <span class="comment"># Check changed successfully</span>
    <span class="keyword">self</span>.assertTrue(<span class="string">'changed successfully'</span> <span class="keyword">in</span> response.content)

    <span class="comment"># Check tag amended</span>
    all_tags = <span class="constant">Tag</span>.objects.all()
    <span class="keyword">self</span>.assertEquals(len(all_tags), <span class="number">1</span>)
    only_tag = all_tags[<span class="number">0</span>]
    <span class="keyword">self</span>.assertEquals(only_tag.name, <span class="string">'perl'</span>)
    <span class="keyword">self</span>.assertEquals(only_tag.description, <span class="string">'The Perl programming language'</span>)

<span class="function"><span class="keyword">def</span> <span class="title">test_delete_tag</span><span class="params">(<span class="keyword">self</span>)</span>:</span>
    <span class="comment"># Create the tag</span>
    tag = <span class="constant">Tag</span>()
    tag.name = <span class="string">'python'</span>
    tag.description = <span class="string">'The Python programming language'</span>
    tag.save()

    <span class="comment"># Log in</span>
    <span class="keyword">self</span>.client.login(username=<span class="string">'bobsmith'</span>, password=<span class="string">"password"</span>)

    <span class="comment"># Delete the tag</span>
    response = <span class="keyword">self</span>.client.post(<span class="string">'/admin/blogengine/tag/1/delete/'</span>, {
        <span class="string">'post'</span><span class="symbol">:</span> <span class="string">'yes'</span>
    }, follow=<span class="constant">True</span>)
    <span class="keyword">self</span>.assertEquals(response.status_code, <span class="number">200</span>)

    <span class="comment"># Check deleted successfully</span>
    <span class="keyword">self</span>.assertTrue(<span class="string">'deleted successfully'</span> <span class="keyword">in</span> response.content)

    <span class="comment"># Check tag deleted</span>
    all_tags = <span class="constant">Tag</span>.objects.all()
    <span class="keyword">self</span>.assertEquals(len(all_tags), <span class="number">0</span>)</code></pre>
<pre><code>
These tests are virtually identical <span class="keyword">to</span> those <span class="keyword">for</span> the `Category` objects, as we plan <span class="keyword">for</span> our `Tag` objects <span class="keyword">to</span> be very similar. Finally, we need <span class="keyword">to</span> amend the acceptance tests <span class="keyword">for</span> `Post` objects <span class="keyword">to</span> include a tag:

``` python blogengine/tests.py
    def test_create_post(self):
        # Create the category
        category = Category()
        category.name = <span class="comment">'python'</span>
        category.description = <span class="comment">'The Python programming language'</span>
        category.save()

        # Create the tag
        tag = Tag()
        tag.name = <span class="comment">'python'</span>
        tag.description = <span class="comment">'The Python programming language'</span>
        tag.save()

        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Check <span class="built_in">response</span> code
        <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(<span class="comment">'/admin/blogengine/post/add/')</span>
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Create the <span class="keyword">new</span> post
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/add/', {</span>
            <span class="comment">'title': 'My first post',</span>
            <span class="comment">'text': 'This is my first post',</span>
            <span class="comment">'pub_date_0': '2013-12-28',</span>
            <span class="comment">'pub_date_1': '22:00:04',</span>
            <span class="comment">'slug': 'my-first-post',</span>
            <span class="comment">'site': '1',</span>
            <span class="comment">'category': '1',</span>
            <span class="comment">'tags': '1'</span>
        },
        follow=<span class="literal">True</span>
        )
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check added successfully
        self.assertTrue(<span class="comment">'added successfully' in response.content)</span>

        # Check <span class="keyword">new</span> post <span class="built_in">now</span> <span class="keyword">in</span> database
        all_posts = Post.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

    def test_edit_post(self):
        # Create the category
        category = Category()
        category.name = <span class="comment">'python'</span>
        category.description = <span class="comment">'The Python programming language'</span>
        category.save()

        # Create the tag
        tag = Tag()
        tag.name = <span class="comment">'python'</span>
        tag.description = <span class="comment">'The Python programming language'</span>
        tag.save()

        # Create the author
        author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
        author.save()

        # Create the site
        site = Site()
        site.name = <span class="comment">'example.com'</span>
        site.domain = <span class="comment">'example.com'</span>
        site.save()

        # Create the post
        post = Post()
        post.title = <span class="comment">'My first post'</span>
        post.text = <span class="comment">'This is my first blog post'</span>
        post.slug = <span class="comment">'my-first-post'</span>
        post.pub_date = timezone.<span class="built_in">now</span>()
        post.author = author
        post.site = site
        post.save()
        post.tags.add(tag)
        post.save()

        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Edit the post
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/1/', {</span>
            <span class="comment">'title': 'My second post',</span>
            <span class="comment">'text': 'This is my second blog post',</span>
            <span class="comment">'pub_date_0': '2013-12-28',</span>
            <span class="comment">'pub_date_1': '22:00:04',</span>
            <span class="comment">'slug': 'my-second-post',</span>
            <span class="comment">'site': '1',</span>
            <span class="comment">'category': '1',</span>
            <span class="comment">'tags': '1'</span>
        },
        follow=<span class="literal">True</span>
        )
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check changed successfully
        self.assertTrue(<span class="comment">'changed successfully' in response.content)</span>

        # Check post amended
        all_posts = Post.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)
        only_post = all_posts[<span class="number">0</span>]
        self.assertEquals(only_post.title, <span class="comment">'My second post')</span>
        self.assertEquals(only_post.text, <span class="comment">'This is my second blog post')</span>

    def test_delete_post(self):
        # Create the category
        category = Category()
        category.name = <span class="comment">'python'</span>
        category.description = <span class="comment">'The Python programming language'</span>
        category.save()

        # Create the tag
        tag = Tag()
        tag.name = <span class="comment">'python'</span>
        tag.description = <span class="comment">'The Python programming language'</span>
        tag.save()

        # Create the author
        author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
        author.save()

        # Create the site
        site = Site()
        site.name = <span class="comment">'example.com'</span>
        site.domain = <span class="comment">'example.com'</span>
        site.save()

        # Create the post
        post = Post()
        post.title = <span class="comment">'My first post'</span>
        post.text = <span class="comment">'This is my first blog post'</span>
        post.slug = <span class="comment">'my-first-post'</span>
        post.pub_date = timezone.<span class="built_in">now</span>()
        post.site = site
        post.author = author
        post.category = category
        post.save()
        post.tags.add(tag)
        post.save()

        # Check <span class="keyword">new</span> post saved
        all_posts = Post.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

        # <span class="built_in">Log</span> <span class="keyword">in</span>
        self.client.login(username=<span class="comment">'bobsmith', password="password")</span>

        # Delete the post
        <span class="built_in">response</span> = self.client.post(<span class="comment">'/admin/blogengine/post/1/delete/', {</span>
            <span class="comment">'post': 'yes'</span>
        }, follow=<span class="literal">True</span>)
        self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

        # Check deleted successfully
        self.assertTrue(<span class="comment">'deleted successfully' in response.content)</span>

        # Check post deleted
        all_posts = Post.objects.all()
        self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">0</span>)</code></pre>
<p>Here we&#39;re just adding tags to our <code>Post</code> objects.</p>
<p>Now it&#39;s time to run our tests to make sure they fail as expected:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
E
======================================================================
ERROR: blogengine.tests (unittest.loader.ModuleImportFailure)
----------------------------------------------------------------------
ImportError: Failed to import test module: blogengine.tests
Traceback (most recent call last):
  File <span class="string">"/usr/local/Cellar/python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/loader.py"</span>, line 254, <span class="keyword">in</span> _find_tests
    module = self._get_module_from_name(name)
  File <span class="string">"/usr/local/Cellar/python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/loader.py"</span>, line 232, <span class="keyword">in</span> _get_module_from_name
    __import__(name)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 3, <span class="keyword">in</span> &lt;module&gt;
    from blogengine.models import Post, Category, Tag
ImportError: cannot import name Tag


----------------------------------------------------------------------
Ran 1 test <span class="keyword">in</span> 0.000s

FAILED (errors=1)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>So here we can&#39;t import our <code>Tag</code> model, because we haven&#39;t created it. So, we&#39;ll do that:</p>
<p>``` python blogengine/models.py
class Tag(models.Model):
    name = models.CharField(max_length=200)
    description = models.TextField()
    slug = models.SlugField(max_length=40, unique=True, blank=True, null=True)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self)</span>:</span>
    <span class="keyword">if</span> <span class="keyword">not</span> self.slug:
        self.slug = slugify(unicode(self.name))
    super(Tag, self).save()

<span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> <span class="string">"/tag/%s/"</span> % (self.slug)

<span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.name</code></pre>
<pre><code>
Our `Tag` model <span class="keyword">is</span> very much like our `Category` model, <span class="keyword">but</span> we don't need <span class="keyword">to</span> change <span class="keyword">the</span> `verbose_name_plural` value, <span class="keyword">and</span> we amend <span class="keyword">the</span> absolute URL <span class="keyword">to</span> show <span class="keyword">it</span> <span class="keyword">as</span> a tag rather than a category.

We also need <span class="keyword">to</span> amend our `Post` model <span class="keyword">to</span> include a `tags` field:

``` python blogengine/models.py
<span class="type">class</span> Post(models.Model):
    title = models.CharField(max_length=<span class="number">200</span>)
    pub_date = models.DateTimeField()
    <span class="type">text</span> = models.TextField()
    slug = models.SlugField(max_length=<span class="number">40</span>, unique=True)
    author = models.ForeignKey(User)
    site = models.ForeignKey(Site)
    category = models.ForeignKey(Category, blank=True, null=True)
    tags = models.ManyToManyField(Tag)

    def get_absolute_url(self):
<span class="command">        return</span> <span class="string">"/%s/%s/%s/"</span> % (self.pub_date.<span class="property">year</span>, self.pub_date.<span class="property">month</span>, self.slug)

    def __unicode__(self):
<span class="command">        return</span> self.title

    <span class="type">class</span> Meta:
        ordering = [<span class="string">"-pub_date"</span>]</code></pre>
<p>Note that <code>tags</code> is a <code>ManyToManyField</code>, and we pass through the model we wish to use, much like we did with the categories. The difference is that one tag can be applied to many posts and a post can have many tags, so we need an intermediate database table to handle the relationship between the two. With Django&#39;s ORM we can handle this quickly and easily.</p>
<p>Run our tests and they should still fail:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
.EE.EF.EE.EE......
======================================================================
ERROR: test_create_post (blogengine.tests.PostTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 64, <span class="keyword">in</span> test_create_post
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_create_tag (blogengine.tests.PostTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 41, <span class="keyword">in</span> test_create_tag
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_create_post (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 335, <span class="keyword">in</span> test_create_post
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_delete_post (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 440, <span class="keyword">in</span> test_delete_post
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_delete_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 306, <span class="keyword">in</span> test_delete_tag
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_edit_post (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 377, <span class="keyword">in</span> test_edit_post
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
ERROR: test_edit_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 279, <span class="keyword">in</span> test_edit_tag
    tag.save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/models.py"</span>, line 34, <span class="keyword">in</span> save
    super(Tag, self).save()
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 545, <span class="keyword">in</span> save
    force_update=force_update, update_fields=update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 573, <span class="keyword">in</span> save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 654, <span class="keyword">in</span> _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/base.py"</span>, line 687, <span class="keyword">in</span> _do_insert
    using=using, raw=raw)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/manager.py"</span>, line 232, <span class="keyword">in</span> _insert
    <span class="keyword">return</span> insert_query(self.model, objs, fields, **kwargs)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/query.py"</span>, line 1511, <span class="keyword">in</span> insert_query
    <span class="keyword">return</span> query.get_compiler(using=using).execute_sql(return_id)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py"</span>, line 898, <span class="keyword">in</span> execute_sql
    cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/utils.py"</span>, line 99, <span class="keyword">in</span> __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/util.py"</span>, line 53, <span class="keyword">in</span> execute
    <span class="keyword">return</span> self.cursor.execute(sql, params)
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py"</span>, line 450, <span class="keyword">in</span> execute
    <span class="keyword">return</span> Database.Cursor.execute(self, query, params)
OperationalError: no such table: blogengine_tag

======================================================================
FAIL: test_create_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 256, <span class="keyword">in</span> test_create_tag
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 18 tests <span class="keyword">in</span> 3.981s

FAILED (failures=1, errors=7)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>Again, we can easily see why they failed - the <code>blogengine_tag</code> table is not in place. So let&#39;s create and run our migrations to fix that:</p>
<pre><code class="lang-bash">python manage.py schemamigration --auto blogengine
python manage.py migrate</code></pre>
<p>Now, we run our tests again:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
.....F..F..F......
======================================================================
FAIL: test_create_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 256, <span class="keyword">in</span> test_create_tag
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

======================================================================
FAIL: test_delete_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 315, <span class="keyword">in</span> test_delete_tag
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

======================================================================
FAIL: test_edit_tag (blogengine.tests.AdminTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 289, <span class="keyword">in</span> test_edit_tag
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 18 tests <span class="keyword">in</span> 5.124s

FAILED (failures=3)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>We can&#39;t yet amend our tags in the admin, because we haven&#39;t registered them. So we do that next:</p>
<p>``` python blogengine/admin.py
import models
from django.contrib import admin
from django.contrib.auth.models import User</p>
<p>class PostAdmin(admin.ModelAdmin):
    prepopulated_fields = {&quot;slug&quot;: (&quot;title&quot;,)}
    exclude = (&#39;author&#39;,)</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">save_model</span><span class="params">(self, request, obj, form, change)</span>:</span>
    obj.author = request.user
    obj.save()</code></pre>
<p>admin.site.register(models.Category)
admin.site.register(models.Tag)
admin.site.register(models.Post, PostAdmin)</p>
<pre><code>
<span class="comment">Now</span>, <span class="comment">if</span> <span class="comment">we</span> <span class="comment">run</span> <span class="comment">our</span> <span class="comment">tests</span>, <span class="comment">they</span> <span class="comment">should</span> <span class="comment">pass:</span>

<span class="comment">```</span> <span class="comment">bash</span>
<span class="comment">(venv)Smith:django_tutorial_blog_ng</span> <span class="comment">matthewdaly$</span> <span class="comment">python</span> <span class="comment">manage</span>.<span class="comment">py</span> <span class="comment">test</span> <span class="comment">blogengine</span>
<span class="comment">Creating</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span>
<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Ran</span> <span class="comment">18</span> <span class="comment">tests</span> <span class="comment">in</span> <span class="comment">5</span>.<span class="comment">444s</span>

<span class="comment">OK</span>
<span class="comment">Destroying</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span></code></pre>
<p>Time to commit our changes:</p>
<pre><code class="lang-bash">git add blogengine/
git commit -m <span class="string">'Implemented tags'</span></code></pre>
<p>Now, like with the categories beforehand, we want to be able to show the tags applied to a post at the base of it, and list all posts for a specific tag. So, first of all, we&#39;ll amend our <code>PostViewTest</code> class to check for the tags:</p>
<p>``` python blogengine/tests.py
class PostViewTest(BaseAcceptanceTest):
    def test_index(self):</p>
<pre><code>    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the tag
    tag = Tag()
    tag.name = <span class="comment">'perl'</span>
    tag.description = <span class="comment">'The Perl programming language'</span>
    tag.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is [my first blog post](http://127.0.0.1:8000/)'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.author = author
    post.site = site
    post.category = category
    post.save()
    post.tags.add(tag)

    # Check <span class="keyword">new</span> post saved
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)

    # Fetch the index
    <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(<span class="comment">'/')</span>
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check the post title <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.title <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post text <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(markdown.markdown(post.text) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post category <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.category.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post tag <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    post_tag = all_posts[<span class="number">0</span>].tags.all()[<span class="number">0</span>]
    self.assertTrue(post_tag.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post <span class="built_in">date</span> <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">year</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)
    self.assertTrue(post.pub_date.strftime(<span class="comment">'%b') in response.content)</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">day</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the link <span class="keyword">is</span> marked up properly
    self.assertTrue(<span class="comment">'&lt;a href="http://127.0.0.1:8000/"&gt;my first blog post&lt;/a&gt;' in response.content)</span>

def test_post_page(self):
    # Create the category
    category = Category()
    category.name = <span class="comment">'python'</span>
    category.description = <span class="comment">'The Python programming language'</span>
    category.save()

    # Create the tag
    tag = Tag()
    tag.name = <span class="comment">'perl'</span>
    tag.description = <span class="comment">'The Perl programming language'</span>
    tag.save()

    # Create the author
    author = User.objects.create_user(<span class="comment">'testuser', 'user@example.com', 'password')</span>
    author.save()

    # Create the site
    site = Site()
    site.name = <span class="comment">'example.com'</span>
    site.domain = <span class="comment">'example.com'</span>
    site.save()

    # Create the post
    post = Post()
    post.title = <span class="comment">'My first post'</span>
    post.text = <span class="comment">'This is [my first blog post](http://127.0.0.1:8000/)'</span>
    post.slug = <span class="comment">'my-first-post'</span>
    post.pub_date = timezone.<span class="built_in">now</span>()
    post.author = author
    post.site = site
    post.category = category
    post.save()
    post.tags.add(tag)
    post.save()

    # Check <span class="keyword">new</span> post saved
    all_posts = Post.objects.all()
    self.assertEquals(<span class="built_in">len</span>(all_posts), <span class="number">1</span>)
    only_post = all_posts[<span class="number">0</span>]
    self.assertEquals(only_post, post)

    # <span class="keyword">Get</span> the post URL
    post_url = only_post.get_absolute_url()

    # Fetch the post
    <span class="built_in">response</span> = self.client.<span class="keyword">get</span>(post_url)
    self.assertEquals(<span class="built_in">response</span>.status_code, <span class="number">200</span>)

    # Check the post title <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.title <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post category <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(post.category.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post tag <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    post_tag = all_posts[<span class="number">0</span>].tags.all()[<span class="number">0</span>]
    self.assertTrue(post_tag.name <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post text <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(markdown.markdown(post.text) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the post <span class="built_in">date</span> <span class="keyword">is</span> <span class="keyword">in</span> the <span class="built_in">response</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">year</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)
    self.assertTrue(post.pub_date.strftime(<span class="comment">'%b') in response.content)</span>
    self.assertTrue(str(post.pub_date.<span class="built_in">day</span>) <span class="keyword">in</span> <span class="built_in">response</span>.content)

    # Check the link <span class="keyword">is</span> marked up properly
    self.assertTrue(<span class="comment">'&lt;a href="http://127.0.0.1:8000/"&gt;my first blog post&lt;/a&gt;' in response.content)</span></code></pre>
<pre><code>
We create a tag near <span class="keyword">the</span> top, <span class="keyword">and</span> check <span class="keyword">for</span> <span class="keyword">the</span> <span class="type">text</span> <span class="keyword">in</span> <span class="keyword">the</span> page (note <span class="keyword">that</span> <span class="keyword">to</span> avoid <span class="constant">false</span> positives <span class="keyword">from</span> <span class="keyword">the</span> categories, we <span class="keyword">set</span> <span class="keyword">the</span> <span class="property">name</span> <span class="keyword">of</span> <span class="keyword">the</span> tags <span class="keyword">to</span> something different). We do this <span class="function_start"><span class="keyword">on</span> <span class="title">both</span></span> <span class="keyword">the</span> index <span class="keyword">and</span> post pages.

We also need <span class="keyword">to</span> <span class="keyword">put</span> a test <span class="keyword">in</span> place <span class="keyword">for</span> <span class="keyword">the</span> tag-specific page:

``` python blogengine/tests.py
    def test_tag_page(self):
        <span class="comment"># Create the tag</span>
        tag = Tag()
        tag.<span class="property">name</span> = 'python'
        tag.description = 'The Python programming language'
        tag.save()

        <span class="comment"># Create the author</span>
        author = User.objects.create_user('testuser', 'user@example.com', 'password')
        author.save()

        <span class="comment"># Create the site</span>
        site = Site()
        site.<span class="property">name</span> = 'example.com'
        site.domain = 'example.com'
        site.save()

        <span class="comment"># Create the post</span>
        post = Post()
        post.title = 'My <span class="keyword">first</span> post'
        post.<span class="type">text</span> = 'This <span class="keyword">is</span> [<span class="keyword">my</span> <span class="keyword">first</span> blog post](http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span>/)'
        post.slug = '<span class="keyword">my</span>-<span class="keyword">first</span>-post'
        post.pub_date = timezone.now()
        post.author = author
        post.site = site
        post.save()
        post.tags.add(tag)

        <span class="comment"># Check new post saved</span>
        all_posts = Post.objects.all()
        self.assertEquals(len(all_posts), <span class="number">1</span>)
        only_post = all_posts[<span class="number">0</span>]
        self.assertEquals(only_post, post)

        <span class="comment"># Get the tag URL</span>
        tag_url = post.tags.all()[<span class="number">0</span>].get_absolute_url()

        <span class="comment"># Fetch the tag</span>
        response = self.client.<span class="keyword">get</span>(tag_url)
        self.assertEquals(response.status_code, <span class="number">200</span>)

        <span class="comment"># Check the tag name is in the response</span>
        self.assertTrue(post.tags.all()[<span class="number">0</span>].<span class="property">name</span> <span class="keyword">in</span> response.content)

        <span class="comment"># Check the post text is in the response</span>
        self.assertTrue(markdown.markdown(post.<span class="type">text</span>) <span class="keyword">in</span> response.content)

        <span class="comment"># Check the post date is in the response</span>
        self.assertTrue(str(post.pub_date.<span class="property">year</span>) <span class="keyword">in</span> response.content)
        self.assertTrue(post.pub_date.strftime('%b') <span class="keyword">in</span> response.content)
        self.assertTrue(str(post.pub_date.<span class="property">day</span>) <span class="keyword">in</span> response.content)

        <span class="comment"># Check the link is marked up properly</span>
        self.assertTrue('&lt;a href=<span class="string">"http://127.0.0.1:8000/"</span>&gt;<span class="keyword">my</span> <span class="keyword">first</span> blog post&lt;/a&gt;' <span class="keyword">in</span> response.content)</code></pre>
<p>Again, this is virtually identical to the category page, adjusted to allow for the fact that we need to get a specific tag. If we now run our tests, they should fail as expected:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
................FFF
======================================================================
FAIL: test_index (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 540, <span class="keyword">in</span> test_index
    self.assertTrue(post_tag.name <span class="keyword">in</span> response.content)
AssertionError: False is not <span class="literal">true</span>

======================================================================
FAIL: test_post_page (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 607, <span class="keyword">in</span> test_post_page
    self.assertTrue(post_tag.name <span class="keyword">in</span> response.content)
AssertionError: False is not <span class="literal">true</span>

======================================================================
FAIL: test_tag_page (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 714, <span class="keyword">in</span> test_tag_page
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 19 tests <span class="keyword">in</span> 5.375s

FAILED (failures=3)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>So, we need to implement the following things:</p>
<ul>
<li>Show tags on the index page</li>
<li>Show tags on the post pages</li>
<li>Create a page listing the posts with a specific tag</li>
</ul>
<p>As we have seen already with the categories, this is actually quite simple. First, we&#39;ll sort out the tags on the index page:</p>
<p>``` html templates/blogengine/post_list.html
{% raw %}{% extends &quot;blogengine/includes/base.html&quot; %}</p>
<pre><code><span class="template_tag">{% <span class="keyword">load</span> custom_markdown %}</span>

<span class="template_tag">{% <span class="keyword">block</span> content %}</span>
    <span class="template_tag">{% <span class="keyword">for</span> post <span class="keyword">in</span> object_list %}</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"post"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h1</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ post.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ post.title }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h3</span>&gt;</span><span class="variable">{{ post.pub_date }}</span><span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
    <span class="variable">{{ post.text<span class="filter">|custom</span>_markdown }}</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ post.category.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ post.category.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">for</span> tag <span class="keyword">in</span> post.tags.all %}</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ tag.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ tag.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endfor</span> %}</span>
    <span class="template_tag">{% <span class="keyword">endfor</span> %}</span>

    <span class="template_tag">{% <span class="keyword">if</span> page_obj.has_previous %}</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/<span class="variable">{{ page_obj.previous_page_number }}</span>/"</span>&gt;</span>Previous Page<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endif</span> %}</span>
    <span class="template_tag">{% <span class="keyword">if</span> page_obj.has_next %}</span>
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/<span class="variable">{{ page_obj.next_page_number }}</span>/"</span>&gt;</span>Next Page<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="template_tag">{% <span class="keyword">endif</span> %}</span>

<span class="template_tag">{% <span class="keyword">endblock</span> %}</span><span class="template_tag">{% endraw %}</span></code></pre>
<pre><code>
This is quite simple. We retrieve all the tags with `post.tags.all` and loop through them. We then do basically the same for the individual post pages:

``` html templates/blogengine/post_detail.html
<span class="template_tag">{% raw %}</span><span class="template_tag">{% <span class="keyword">extends</span> "blogengine/includes/base.html" %}</span>

    <span class="template_tag">{% <span class="keyword">load</span> custom_markdown %}</span>

    <span class="template_tag">{% <span class="keyword">block</span> content %}</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"post"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">h1</span>&gt;</span><span class="variable">{{ object.title }}</span><span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
        <span class="tag">&lt;<span class="title">h3</span>&gt;</span><span class="variable">{{ object.pub_date }}</span><span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
        <span class="variable">{{ object.text<span class="filter">|custom</span>_markdown }}</span>
        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ object.category.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ object.category.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>
        <span class="template_tag">{% <span class="keyword">for</span> tag <span class="keyword">in</span> post.tags.all %}</span>
        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"<span class="variable">{{ tag.get_absolute_url }}</span>"</span>&gt;</span><span class="variable">{{ tag.name }}</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span>
        <span class="template_tag">{% <span class="keyword">endfor</span> %}</span>

        <span class="tag">&lt;<span class="title">h4</span>&gt;</span>Comments<span class="tag">&lt;/<span class="title">h4</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"fb-comments"</span> <span class="attribute">data-href</span>=<span class="value">"http://<span class="variable">{{ post.site }}</span><span class="variable">{{ post.get_absolute_url }}</span>"</span> <span class="attribute">data-width</span>=<span class="value">"470"</span> <span class="attribute">data-num-posts</span>=<span class="value">"10"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>

        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

    <span class="template_tag">{% <span class="keyword">endblock</span> %}</span><span class="template_tag">{% endraw %}</span></code></pre>
<p>This should resolve two of our outstanding tests:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
..................F
======================================================================
FAIL: test_tag_page (blogengine.tests.PostViewTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 714, <span class="keyword">in</span> test_tag_page
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 19 tests <span class="keyword">in</span> 5.440s

FAILED (failures=1)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>The final test is for the tag pages. As we saw with the categories, we can limit our querysets on specific pages. So we&#39;ll extend the <code>ListView</code> generic view again to handle tags:</p>
<p>``` python blogengine/views.py
from django.shortcuts import render
from django.views.generic import ListView
from blogengine.models import Category, Post, Tag</p>
<h1 id="create-your-views-here-">Create your views here.</h1>
<p>class CategoryListView(ListView):
    def get_queryset(self):
        slug = self.kwargs[&#39;slug&#39;]
        try:
            category = Category.objects.get(slug=slug)
            return Post.objects.filter(category=category)
        except Category.DoesNotExist:
            return Post.objects.none()</p>
<p>class TagListView(ListView):
    def get_queryset(self):
        slug = self.kwargs[&#39;slug&#39;]
        try:
            tag = Tag.objects.get(slug=slug)
            return tag.post_set.all()
        except Tag.DoesNotExist:
            return Post.objects.none()</p>
<pre><code><span class="xml">
Note that here, `Tag` objects have access to their assigned `Post` objects - we just use `post_set` to refer to them and get all of the posts associated with that tag. Next we'll add the URLconfs:

``` python blogengine/urls.py
from django.conf.urls import patterns, url
from django.views.generic import ListView, DetailView
from blogengine.models import Post, Category, Tag
from blogengine.views import CategoryListView, TagListView

urlpatterns = patterns('',
    # Index
    url(r'^(?P<span class="tag">&lt;<span class="title">page</span>&gt;</span>\d+)?/?$', ListView.as_view(
        model=Post,
        paginate_by=</span><span class="number">5</span><span class="xml">,
        )),

    # Individual posts
    url(r'^(?P<span class="tag">&lt;<span class="title">pub_date__year</span>&gt;</span>\d{</span><span class="number">4</span><span class="xml">})/(?P<span class="tag">&lt;<span class="title">pub_date__month</span>&gt;</span>\d{</span><span class="number">1</span><span class="xml">,</span><span class="number">2</span><span class="xml">})/(?P<span class="tag">&lt;<span class="title">slug</span>&gt;</span>[a-zA-Z0-</span><span class="number">9</span><span class="xml">-]+)/?$', DetailView.as_view(
        model=Post,
        )),

    # Categories
    url(r'</span><span class="keyword">^category</span><span class="xml">/(?P<span class="tag">&lt;<span class="title">slug</span>&gt;</span>[a-zA-Z0-</span><span class="number">9</span><span class="xml">-]+)/?$', CategoryListView.as_view(
        paginate_by=</span><span class="number">5</span><span class="xml">,
        model=Category,
        )),

    # Tags
    url(r'</span><span class="keyword">^tag</span><span class="xml">/(?P<span class="tag">&lt;<span class="title">slug</span>&gt;</span>[a-zA-Z0-</span><span class="number">9</span><span class="xml">-]+)/?$', TagListView.as_view(
        paginate_by=</span><span class="number">5</span><span class="xml">,
        model=Tag,
        )),
)</span></code></pre>
<p>We import the <code>Tag</code> model and the <code>TagListView</code> view, and use them to set up the tag page.</p>
<p>If we now run our tests again, they should pass:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
...................
----------------------------------------------------------------------
Ran 19 tests <span class="keyword">in</span> 5.473s

OK
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>Well done! Time to commit:</p>
<pre><code class="lang-bash">git add templates/ blogengine/
git commit -m <span class="string">'Tags are now shown'</span></code></pre>
<h2 id="rss-feed">RSS Feed</h2>
<p>For the final task today, we&#39;ll implement an RSS feed for our posts. Django ships with a handy syndication framework that makes it easy to implement this kind of functionality.</p>
<p>As usual, we&#39;ll create some tests first. In this case, we won&#39;t be adding any new models, so we don&#39;t need to test them. Instead we can jump straight into creating acceptance tests for our feed. For now we&#39;ll just create one type of feed: a feed of all the blog posts. In a later instalment we&#39;ll add feeds for categories and tags.</p>
<p>First of all, we&#39;ll implement our test. Now, in order to test our feed, we need to have a solution in place for parsing an RSS feed. Django won&#39;t do this natively, so we&#39;ll install the <code>feedparser</code> Python module. Run the following commands:</p>
<pre><code class="lang-bash">pip install feedparser
pip freeze &gt; requirements.txt</code></pre>
<p>Once that&#39;s done, feedparser should be available. You may wish to refer to the <a href="http://pythonhosted.org/feedparser/">documentation</a> as we go to help.</p>
<p>Let&#39;s write our test for the RSS feed. First, we import feedparser near the top of the file:</p>
<p>``` python blogengine/tests.py
import feedparser</p>
<pre><code>
Then we define a <span class="keyword">new</span> <span class="class"><span class="keyword">class</span> <span class="title">for</span> <span class="title">our</span> <span class="title">feed</span> <span class="title">tests</span>. <span class="title">Put</span> <span class="title">this</span> <span class="title">towards</span> <span class="title">the</span> <span class="title">end</span> <span class="title">of</span> <span class="title">the</span> <span class="title">file</span> - <span class="title">I</span> <span class="title">put</span> <span class="title">it</span> <span class="title">just</span> <span class="title">before</span> <span class="title">the</span> <span class="title">flat</span> <span class="title">page</span> <span class="title">tests</span>:

``` <span class="title">python</span> <span class="title">blogengine</span>/<span class="title">tests</span>.<span class="title">py</span>
<span class="title">class</span> <span class="title">FeedTest</span>(<span class="title">BaseAcceptanceTest</span>):
    <span class="title">def</span> <span class="title">test_all_post_feed</span>(<span class="title">self</span>):
        # <span class="title">Create</span> <span class="title">the</span> <span class="title">category</span>
        <span class="title">category</span> = <span class="title">Category</span>()
        <span class="title">category</span>.<span class="title">name</span> = '<span class="title">python</span>'
        <span class="title">category</span>.<span class="title">description</span> = '<span class="title">The</span> <span class="title">Python</span> <span class="title">programming</span> <span class="title">language</span>'
        <span class="title">category</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">tag</span>
        <span class="title">tag</span> = <span class="title">Tag</span>()
        <span class="title">tag</span>.<span class="title">name</span> = '<span class="title">python</span>'
        <span class="title">tag</span>.<span class="title">description</span> = '<span class="title">The</span> <span class="title">Python</span> <span class="title">programming</span> <span class="title">language</span>'
        <span class="title">tag</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">author</span>
        <span class="title">author</span> = <span class="title">User</span>.<span class="title">objects</span>.<span class="title">create_user</span>('<span class="title">testuser</span>', '<span class="title">user</span>@<span class="title">example</span>.<span class="title">com</span>', '<span class="title">password</span>')
        <span class="title">author</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">the</span> <span class="title">site</span>
        <span class="title">site</span> = <span class="title">Site</span>()
        <span class="title">site</span>.<span class="title">name</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">domain</span> = '<span class="title">example</span>.<span class="title">com</span>'
        <span class="title">site</span>.<span class="title">save</span>()

        # <span class="title">Create</span> <span class="title">a</span> <span class="title">post</span>
        <span class="title">post</span> = <span class="title">Post</span>()
        <span class="title">post</span>.<span class="title">title</span> = '<span class="title">My</span> <span class="title">first</span> <span class="title">post</span>'
        <span class="title">post</span>.<span class="title">text</span> = '<span class="title">This</span> <span class="title">is</span> <span class="title">my</span> <span class="title">first</span> <span class="title">blog</span> <span class="title">post</span>'
        <span class="title">post</span>.<span class="title">slug</span> = '<span class="title">my</span>-<span class="title">first</span>-<span class="title">post</span>'
        <span class="title">post</span>.<span class="title">pub_date</span> = <span class="title">timezone</span>.<span class="title">now</span>()
        <span class="title">post</span>.<span class="title">author</span> = <span class="title">author</span>
        <span class="title">post</span>.<span class="title">site</span> = <span class="title">site</span>
        <span class="title">post</span>.<span class="title">category</span> = <span class="title">category</span>

        # <span class="title">Save</span> <span class="title">it</span>
        <span class="title">post</span>.<span class="title">save</span>()

        # <span class="title">Add</span> <span class="title">the</span> <span class="title">tag</span>
        <span class="title">post</span>.<span class="title">tags</span>.<span class="title">add</span>(<span class="title">tag</span>)
        <span class="title">post</span>.<span class="title">save</span>()

        # <span class="title">Check</span> <span class="title">we</span> <span class="title">can</span> <span class="title">find</span> <span class="title">it</span>
        <span class="title">all_posts</span> = <span class="title">Post</span>.<span class="title">objects</span>.<span class="title">all</span>()
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">len</span>(<span class="title">all_posts</span>), 1)
        <span class="title">only_post</span> = <span class="title">all_posts</span>[0]
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">only_post</span>, <span class="title">post</span>)

        # <span class="title">Fetch</span> <span class="title">the</span> <span class="title">feed</span>
        <span class="title">response</span> = <span class="title">self</span>.<span class="title">client</span>.<span class="title">get</span>('/<span class="title">feeds</span>/<span class="title">posts</span>/')
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">response</span>.<span class="title">status_code</span>, 200)

        # <span class="title">Parse</span> <span class="title">the</span> <span class="title">feed</span>
        <span class="title">feed</span> = <span class="title">feedparser</span>.<span class="title">parse</span>(<span class="title">response</span>.<span class="title">content</span>)

        # <span class="title">Check</span> <span class="title">length</span>
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">len</span>(<span class="title">feed</span>.<span class="title">entries</span>), 1)

        # <span class="title">Check</span> <span class="title">post</span> <span class="title">retrieved</span> <span class="title">is</span> <span class="title">the</span> <span class="title">correct</span> <span class="title">one</span>
        <span class="title">feed_post</span> = <span class="title">feed</span>.<span class="title">entries</span>[0]
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">feed_post</span>.<span class="title">title</span>, <span class="title">post</span>.<span class="title">title</span>)
        <span class="title">self</span>.<span class="title">assertEquals</span>(<span class="title">feed_post</span>.<span class="title">description</span>, <span class="title">post</span>.<span class="title">text</span>)</code></pre>
<p>Run the tests and you&#39;ll see something like this:</p>
<pre><code class="lang-bash">(venv)Smith:django_tutorial_blog_ng matthewdaly$ python manage.py test blogengine
Creating test database <span class="keyword">for</span> alias <span class="string">'default'</span>...
..............F.....
======================================================================
FAIL: test_all_post_feed (blogengine.tests.FeedTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File <span class="string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 781, <span class="keyword">in</span> test_all_post_feed
    self.assertEquals(response.status_code, 200)
AssertionError: 404 != 200

----------------------------------------------------------------------
Ran 20 tests <span class="keyword">in</span> 6.743s

FAILED (failures=1)
Destroying test database <span class="keyword">for</span> alias <span class="string">'default'</span>...</code></pre>
<p>We&#39;re getting a 404 error because the post feed isn&#39;t implemented. So let&#39;s implement it. We&#39;re going to use Django&#39;s syndication framework, which will make it easy, but we need to enable it. Open up <code>django_tutorial_blog_ng/settings/py</code> and add the following under <code>INSTALLED_APPS</code>:</p>
<p>``` python django_tutorial_blog_ng/settings.py
    &#39;django.contrib.syndication&#39;,</p>
<pre><code>
Next, we need <span class="keyword">to</span> enable <span class="keyword">the</span> URLconf <span class="keyword">for</span> this RSS feed. Open up `blogengine/urls.py <span class="keyword">and</span> amend <span class="keyword">the</span> import <span class="keyword">from</span> `blogengine.views` near <span class="keyword">the</span> top:

``` python blogengine/urls.py
<span class="keyword">from</span> blogengine.views import CategoryListView, TagListView, PostsFeed</code></pre>
<p>Further down, add in the following code to define the URL for the feed:</p>
<p>``` python blogengine/urls.py</p>
<pre><code><span class="comment"># Post RSS feed</span>
url(<span class="string">r'^feeds/posts/$'</span>, PostsFeed()),</code></pre>
<pre><code>
Note <span class="keyword">that</span> we imported <span class="keyword">the</span> PostsFeed <span class="type">class</span>, <span class="keyword">but</span> <span class="keyword">that</span> hasn't yet been defined. So we need <span class="keyword">to</span> do <span class="keyword">that</span>. First <span class="keyword">of</span> all, add this line near <span class="keyword">the</span> top:

``` python blogengine/views.py
<span class="keyword">from</span> django.contrib.syndication.views import Feed</code></pre>
<p>This imports the syndication views - yes, they&#39;re another generic view! Our <code>PostsFeed</code> class is going to inherit from <code>Feed</code>. Next, we define the class:</p>
<p>``` python blogengine/views.py
class PostsFeed(Feed):
    title = &quot;RSS feed - posts&quot;
    link = &quot;feeds/posts/&quot;
    description = &quot;RSS feed - blog posts&quot;</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">items</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> Post.objects.order_by(<span class="string">'-pub_date'</span>)

<span class="function"><span class="keyword">def</span> <span class="title">item_title</span><span class="params">(self, item)</span>:</span>
    <span class="keyword">return</span> item.title

<span class="function"><span class="keyword">def</span> <span class="title">item_description</span><span class="params">(self, item)</span>:</span>
    <span class="keyword">return</span> item.text</code></pre>
<pre><code>
<span class="comment">This</span> <span class="comment">is</span> <span class="comment">fairly</span> <span class="comment">straightforward</span>. <span class="comment">We</span> <span class="comment">define</span> <span class="comment">our</span> <span class="comment">title</span>, <span class="comment">link</span>, <span class="comment">and</span> <span class="comment">description</span> <span class="comment">for</span> <span class="comment">the</span> <span class="comment">feed</span> <span class="comment">inside</span> <span class="comment">the</span> <span class="comment">class</span> <span class="comment">definition</span>. <span class="comment">We</span> <span class="comment">define</span> <span class="comment">the</span> <span class="comment">`items`</span> <span class="comment">method</span> <span class="comment">which</span> <span class="comment">sets</span> <span class="comment">what</span> <span class="comment">items</span> <span class="comment">are</span> <span class="comment">returned</span> <span class="comment">by</span> <span class="comment">the</span> <span class="comment">RSS</span> <span class="comment">feed</span>. <span class="comment">We</span> <span class="comment">also</span> <span class="comment">define</span> <span class="comment">the</span> <span class="comment">`item_title`</span> <span class="comment">and</span> <span class="comment">`item_description`</span> <span class="comment">methods</span>.

<span class="comment">Now</span>, <span class="comment">if</span> <span class="comment">we</span> <span class="comment">run</span> <span class="comment">our</span> <span class="comment">tests</span>, <span class="comment">they</span> <span class="comment">should</span> <span class="comment">pass:</span>

<span class="comment">```</span> <span class="comment">bash</span>
<span class="comment">(venv)Smith:django_tutorial_blog_ng</span> <span class="comment">matthewdaly$</span> <span class="comment">python</span> <span class="comment">manage</span>.<span class="comment">py</span> <span class="comment">test</span> <span class="comment">blogengine</span>
<span class="comment">Creating</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span>
<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
<span class="comment">Ran</span> <span class="comment">20</span> <span class="comment">tests</span> <span class="comment">in</span> <span class="comment">5</span>.<span class="comment">933s</span>

<span class="comment">OK</span>
<span class="comment">Destroying</span> <span class="comment">test</span> <span class="comment">database</span> <span class="comment">for</span> <span class="comment">alias</span> <span class="comment">'default'</span>.<span class="string">.</span><span class="string">.</span></code></pre>
<p>Let&#39;s commit our changes:</p>
<pre><code class="lang-bash">git add blogengine/ django_tutorial_blog_ng/ requirements.txt
git commit -m <span class="string">'RSS feed implemented'</span></code></pre>
<p>And that&#39;s enough for now. Don&#39;t forget, you can get the code for this lesson by cloning the repository from <a href="https://github.com/matthewbdaly/django_tutorial_blog_ng">Github</a> and running <code>git checkout lesson-4</code> to switch to this lesson.</p>
<p>Next time we&#39;ll:</p>
<ul>
<li>Implement a search system</li>
<li>Add feeds for categories and posts</li>
<li>Tidy up the user interface</li>
</ul>
<p>Hope to see you then!</p>

  </section>
    <section>
        <p>
          15th February 2014
          
            by Matthew Daly
          
        </p>
    </section>

  <ul class="pager">
      
        <li><a href="/posts/2014-05-24-django-blog-tutorial-the-next-generation-part-5.html">Newer</a></li>
      
      
        <li><a href="/posts/2014-01-25-my-first-yeoman-generator.html">Older</a></li>
      
    </ul>
  <section class="comments">
    
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        window.disqus_identifier="";
        window.disqus_url="http://www.matthewdaly.co.uk/posts/2014-02-15-django-blog-tutorial-the-next-generation-part-4.html";
        window.disqus_title="Django blog tutorial - the next generation - part 4";
      </script>
        <script type="text/javascript" src="http://disqus.com/forums/mattbd/embed.js"></script>
        <noscript><a href="http://mattbd.disqus.com/?url=ref">View the discussion thread.</a></noscript>
    
    
  </section>
</article>

        </div>

        <footer>
            <div class="container">
                Copyright Matthew Daly, 2014.
            </div>
        </footer>
        <script type="text/javascript" src="/static/js/dependencies.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
